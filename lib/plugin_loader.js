// Generated by CoffeeScript 1.4.0
var Exception, Node, PluginFactory, PluginRegister;

Node = require('./node');

Exception = require('./exception');

PluginRegister = require('./plugin_register');

module.exports = PluginFactory = {
  load: function(pluginName, config) {
    var plugin, stack;
    plugin = PluginFactory.validate(require(pluginName));
    stack = require('./nez').stack;
    stack.name = pluginName;
    plugin.configure(stack.stacker, config);
    PluginRegister.register(plugin);
    stack.on('edge', plugin.edge);
    return stack.stacker;
  },
  validate: function(plugin) {
    if (typeof plugin.configure !== 'function') {
      throw Exception.create('INVALID_PLUGIN', 'Undefined Plugin.configure()');
    }
    if (typeof plugin.edge !== 'function') {
      throw Exception.create('INVALID_PLUGIN', 'Undefined Plugin.edge()');
    }
    return plugin;
  }
};
