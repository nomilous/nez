// Generated by CoffeeScript 1.4.0
var DevCoffee, fs, hound;

fs = require('fs');

hound = require('hound');

module.exports = DevCoffee = (function() {

  function DevCoffee(program) {
    var app, dir;
    this.program = program;
    try {
      dir = fs.lstatSync('./lib');
      if (dir.isDirectory) {
        app = './lib';
      }
    } catch (_error) {}
    try {
      dir = fs.lstatSync('./app');
      if (dir.isDirectory) {
        if (app) {
          console.log('Appologies. Supports ./app OR ./lib dirs. Not both.');
          return;
        }
        app = './app';
      }
    } catch (_error) {}
    this.config = {
      spec: this.program.specdir || './spec',
      src: this.program.srcdir || './src',
      app: app || './app'
    };
  }

  DevCoffee.prototype.start = function() {
    console.log("running config:", this.config);
    this.watch('spec', this.onchange);
    return this.watch('src', this.onchange);
  };

  DevCoffee.prototype.watch = function(what, onchange) {
    var watcher;
    console.log('Watching: ', this.config[what]);
    watcher = hound.watch(this.config[what]);
    return watcher.on('change', function(file, stats) {
      return onchange(what, file, stats);
    });
  };

  DevCoffee.prototype.onchange = function(what, file, stats) {
    return console.log('changed %s file: %s', what, file);
  };

  return DevCoffee;

})();
