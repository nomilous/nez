// Generated by CoffeeScript 1.6.3
var Notice, Phrase;

Notice = require('notice');

Phrase = require('phrase');

module.exports = function(opts, objectiveFn) {
  opts || (opts = {});
  opts.title || (opts.title = 'untitled');
  opts.uuid || (opts.uuid = '0');
  return Notice.listen("objective/" + opts.uuid, opts, function(error, hub) {
    if (error != null) {
      try {
        delete opts.listen.secret;
      } catch (_error) {}
      try {
        delete opts.listening;
      } catch (_error) {}
      console.log({
        OPTS: opts,
        ERROR: error
      });
      process.exit(1);
    }
    return Phrase.createRoot(opts, function(token, notice) {
      return token.on('ready', function(data) {
        return console.log(data);
      });
    })(objectiveFn);
  });
};
