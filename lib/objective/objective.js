// Generated by CoffeeScript 1.6.3
var eo, inject, notice;

notice = require('notice');

eo = require('eo');

inject = require('also').inject;

module.exports = function(title, opts, objectiveFn) {
  var key, objective, options;
  if (typeof title !== 'string') {
    throw new Error('objective(title, opts, fn) requires title as string');
  }
  if (typeof opts === 'function') {
    objectiveFn = opts;
    opts = {};
  }
  if (typeof objectiveFn !== 'function') {
    throw new Error('objective(title, opts, fn) requires function as last argument');
  }
  options = {
    title: title
  };
  for (key in opts) {
    options[key] = opts[key];
  }
  objective = inject.sync({
    beforeEach: opts.beforeEach || function(context) {},
    beforeAll: function(context) {
      context.first.push(options);
      context.first.push(notice.create('objective', opts.messenger || eo.messenger));
      if (typeof opts.beforeAll === 'function') {
        return opts.beforeAll.apply(null, arguments);
      }
    }
  }, function(context, notifier, fn) {
    return eo(options, notifier, fn);
  });
  return objective(objectiveFn);
};
